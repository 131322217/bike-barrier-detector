<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Curve vs Step</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<canvas id="chart"></canvas>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

const app = initializeApp({
  apiKey: "AIzaSyAb9Zt2Hw_o-wXfXby6vlBDdcWZ6xZUJpo",
  projectId: "bike-barrier-detector-1e128"
});
const db = getFirestore(app);

const step = [], curve = [];

const snap = await getDocs(collection(db, "logs"));
snap.forEach(doc => {
  const d = doc.data();
  const x = Math.abs(d.x) + Math.abs(d.y);
  const y = Math.abs(d.z);
  (d.type === "step" ? step : curve).push({ x, y });
});

new Chart(document.getElementById("chart"), {
  type: "scatter",
  data: {
    datasets: [
      { label: "Step", data: step, backgroundColor: "red" },
      { label: "Curve", data: curve, backgroundColor: "blue" }
    ]
  },
  options: {
    scales: {
      x: { title: { display: true, text: "|x|+|y|" }},
      y: { title: { display: true, text: "|z|" }}
    }
  }
});
</script>
</body>
</html>
